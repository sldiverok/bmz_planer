<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å –ë–ú–ó</title>
<link rel="icon" type="image/png" href="favicon.png">
<style>
body {
  background-color: #1c1c1c;
  color: #f5f5f5;
  font-family: "Segoe UI", sans-serif;
  margin: 0;
  padding: 20px;
}
h1 {
  text-align: center;
  color: #00c0c4;
}
input, select {
  padding: 8px 12px;
  border-radius: 6px;
  border: none;
  background-color: #2a2a2a;
  color: #fff;
  outline: none;
}
table {
  width: 100%;
  border-collapse: collapse;
  background-color: #2b2b2b;
  margin-top: 15px;
}
th, td {
  padding: 10px;
  border-bottom: 1px solid #3a3a3a;
  text-align: left;
}
th {
  background-color: #333;
}
tr:hover {
  background-color: #3d3d3d;
}
a {
  color: #00c0c4;
  text-decoration: none;
}
a:hover {
  text-decoration: underline;
}
button {
  background: #00c0c4;
  border: none;
  color: #fff;
  font-weight: bold;
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
}
button:hover {
  background: #00969a;
}
input[contenteditable="true"], td[contenteditable="true"] {
  border-bottom: 1px dashed #00c0c4;
  outline: none;
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>

<body>
<h1>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó</h1>

<div id="loginBlock">
  <input type="password" id="adminPass" placeholder="üîê –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
  <button onclick="login()">–£–≤—ñ–π—Ç–∏</button>
</div>

<div id="panel" style="display:none;">
  <div class="filter-bar">
    <select id="unitFilter">
      <option value="all">–í—Å—ñ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏</option>
    </select>
    <button onclick="exportCSV()">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ CSV</button>
  </div>

  <table id="bmzTable">
    <thead>
      <tr>
        <th>–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</th>
        <th>–ü–æ—Å–∞–¥–∞</th>
        <th>–ü–Ü–ë</th>
        <th>–®–ü–ö</th>
        <th>–í—ñ–π—Å—å–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
const structuralPositions = [
  "–ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å–∞–º–∏",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–¢–∞–∫–µ–ª–∞–∂–Ω–∏–π –≤–∑–≤–æ–¥",
  "–¢–∞–∫–µ–ª–∞–∂–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ü–æ–ª—å–æ–≤–∏–π –∞—Ä—Ç–∏–ª–µ—Ä—ñ–π—Å—å–∫–∏–π —Å–∫–ª–∞–¥",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–Ω–∞—Ä—è–¥—ñ–≤",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤ –¥–æ –Ω–∞–∑–µ–º–Ω–æ—ó –∞—Ä—Ç–∏–ª–µ—Ä—ñ—ó",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∏—Ö –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–æ—ó –∑–±—Ä–æ—ó",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–∞—Å–æ–±—ñ–≤ –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ–º, —Ä–µ—á–æ–≤–∏–º —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–∏–º –º–∞–π–Ω–æ–º",
  "–í–∑–≤–æ–¥ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞, —Ä–µ—á–æ–≤–æ–≥–æ —ñ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞",
  "–°–∫–ª–∞–¥ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞",
  "–ü—Ä–æ–¥–æ–≤–æ–ª—å—á–∏–π —Å–∫–ª–∞–¥",
  "–†–µ—á–æ–≤–∏–π —Å–∫–ª–∞–¥",
  "–ì–æ—Å–ø–æ–¥–∞—Ä—á–∏–π –≤–∑–≤–æ–¥",
  "–á–¥–∞–ª—å–Ω—è",
  "–†–µ–º–æ–Ω—Ç–Ω–∞ –º–∞–π—Å—Ç–µ—Ä–Ω—è —Ä–µ—á–æ–≤–æ–≥–æ –º–∞–π–Ω–∞",
  "–ü–æ–ª—å–æ–≤–∞ –ª–∞–∑–Ω—è",
  "–°–∫–ª–∞–¥–∏",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "–°–∫–ª–∞–¥ –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "–í–∑–≤–æ–¥ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ-–µ–≤–∞–∫—É–∞—Ü—ñ–π–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º",
  "1 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "2 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–í—ñ–¥—ñ–ª–µ–Ω–Ω—è –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É",
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ü–∏–≤—ñ–ª—å–Ω–æ-–≤—ñ–π—Å—å–∫–æ–≤–æ–≥–æ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏—Ü—Ç–≤–∞",
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É",
  "–í–∑–≤–æ–¥ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ì–æ—Å–ø–æ–¥–∞—Ä—á–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ü–æ–ª—å–æ–≤–∞ –ª–∞–∑–Ω—è",
  "–ü–æ–∂–µ–∂–Ω–∞ –æ–±—Å–ª—É–≥–∞",
  "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç"
];

let data = [];

function login() {
  const pass = document.getElementById("adminPass").value.trim();
  if (pass === "admin123") {
    sessionStorage.setItem("bmz_unit", "ADMIN");
    document.getElementById("loginBlock").style.display = "none";
    document.getElementById("panel").style.display = "block";
    loadData();
  } else {
    alert("‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å!");
  }
}

window.addEventListener("load", () => {
  if (sessionStorage.getItem("bmz_unit") === "ADMIN") {
    document.getElementById("loginBlock").style.display = "none";
    document.getElementById("panel").style.display = "block";
    loadData();
  }
});

function loadData() {
  Papa.parse("bmz.csv", {
    download: true,
    header: true,
    delimiter: ";",
    complete: function(res) {
      data = res.data;
      fillFilter(data);
      renderTable(data);
    }
  });
}

function fillFilter(d) {
  const u = [...new Set(d.map(r => r["–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª"]).filter(Boolean))].sort();
  const s = document.getElementById("unitFilter");
  u.forEach(v => {
    const o = document.createElement("option");
    o.value = v;
    o.textContent = v;
    s.appendChild(o);
  });
  s.addEventListener("change", () => {
    const val = s.value;
    renderTable(val === "all" ? data : data.filter(r => r["–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª"] === val));
  });
}

function renderTable(arr) {
  const tbody = document.querySelector("#bmzTable tbody");
  tbody.innerHTML = "";
  arr.forEach(r => {
    const tr = document.createElement("tr");
    const page = r["–ü–Ü–ë_–ª–∞—Ç"] ? `soldiers/${r["–ü–Ü–ë_–ª–∞—Ç"]}.html` : "#";
    tr.innerHTML = `
      <td contenteditable="true">${r["–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª–ö–æ–¥"] || ""} ${r["–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª"] || ""}</td>
      <td contenteditable="true">${r["–ü–æ—Å–∞–¥–∞"] || ""}</td>
      <td contenteditable="true">${
        r["–ü–Ü–ë"]
          ? `<a href="${page}" target="_blank">${r["–ü–Ü–ë"]}</a>`
          : structuralPositions.includes(r["–ü–æ—Å–∞–¥–∞"])
            ? `<b style='color:#00c0c4;'>${r["–ü–æ—Å–∞–¥–∞"]}</b>`
            : "<i>–ù–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ</i>"
      }</td>
      <td contenteditable="true">${r["–®–ü–ö"] || ""}</td>
      <td contenteditable="true">${r["–í—ñ–π—Å—å–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è"] || ""}</td>
    `;
    tbody.appendChild(tr);
  });
}

function exportCSV() {
  const rows = [["–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª","–ü–æ—Å–∞–¥–∞","–ü–Ü–ë","–®–ü–ö","–í—ñ–π—Å—å–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è"]];
  document.querySelectorAll("#bmzTable tbody tr").forEach(tr=>{
    const cols = tr.querySelectorAll("td");
    rows.push(Array.from(cols).map(td=>td.innerText.trim()));
  });
  const csv = Papa.unparse(rows);
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "bmz_admin_export.csv";
  a.click();
}
</script>
</body>
</html>
