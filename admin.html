<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    body {
      background-color: #1a1a1a;
      color: #f5f5f5;
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #111;
      padding: 15px;
      text-align: center;
      font-size: 1.6em;
      color: #00c0c4;
      border-bottom: 2px solid #00c0c4;
    }
    #logout {
      position: absolute;
      top: 15px;
      right: 20px;
      background-color: #00c0c4;
      color: #111;
      border: none;
      padding: 6px 12px;
      font-size: 14px;
      border-radius: 6px;
      cursor: pointer;
    }
    select {
      margin: 15px 20px;
      background-color: #2a2a2a;
      color: #fff;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 5px 10px;
    }
    table {
      width: 96%;
      margin: 0 auto 30px auto;
      border-collapse: collapse;
    }
    th, td {
      border-bottom: 1px solid #333;
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #222;
      color: #8aff8a;
    }
    tr:hover td {
      background-color: #252525;
    }
    td a, .pib-link {
      color: #00c0c4;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }
    td a:hover, .pib-link:hover {
      color: #80ffff;
    }
    footer {
      text-align: center;
      font-size: 0.9em;
      color: #888;
      padding-bottom: 20px;
    }

    /* –ü—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏-—Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∏ */
    .divider-row td {
      background-color: #3a3000;
      color: #ffeb80;
      font-weight: bold;
      text-align: center;
      border-top: 2px solid #555;
      border-bottom: 2px solid #555;
      padding: 8px 0;
    }

    /* –ö–æ–ª—å–æ—Ä–∏ –®–ü–ö */
    .shpk-green, .rank-green { color: #80ff80; }
    .shpk-red, .rank-red { color: #ff7070; }

    /* –ú–æ–¥–∞–ª—å–Ω–µ —Ñ–æ—Ç–æ */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.4s ease, background 0.4s ease;
    }
    .modal.active {
      background: rgba(0,0,0,0.9);
      opacity: 1;
    }
    .modal img {
      max-width: 60%;
      border: 3px solid #9fffa1;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .modal img:hover { transform: scale(1.02); }
    .modal button {
      margin-top: 15px;
      padding: 6px 14px;
      background: #00c0c4;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .modal button:hover { background: #22d4d8; }
  </style>
</head>
<body>
<header id="header">–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó</header>
<button id="logout" style="display:none;">üö™ –í–∏–π—Ç–∏</button>

<select id="unitFilter">
  <option value="all">–í—Å—ñ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏</option>
</select>

<table id="dataTable">
  <thead>
    <tr>
      <th>–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</th>
      <th>–ü–æ—Å–∞–¥–∞</th>
      <th>–ü–Ü–ë</th>
      <th>–®–ü–ö</th>
      <th>–í—ñ–π—Å—å–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<footer>¬© 2025 –ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è | –í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É</footer>

<script>
// === –ü—Ä–æ—Å—Ç—ñ –ø–∞—Ä–æ–ª—ñ —Ä–æ–ª–µ–π ===
const roles = {
  admin: "admin123", upr: "upr123", rzb: "rzb123", rzpr: "rzpr123", pmm: "pmm123",
  lebns: "lebns123", vzv: "vzv123", cvs: "cvs123", rekr: "rekr123", vmz: "vmz123", po: "po123", mp: "mp123"
};

// === –°–ø–∏—Å–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ (–¥–ª—è —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫—ñ–≤) ===
const unitNames = [
  "–ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è","–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å–∞–º–∏","–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è","2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è","–¢–∞–∫–µ–ª–∞–∂–Ω–∏–π –≤–∑–≤–æ–¥","–¢–∞–∫–µ–ª–∞–∂–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è","–ü–æ–ª—å–æ–≤–∏–π –∞—Ä—Ç–∏–ª–µ—Ä—ñ–π—Å—å–∫–∏–π —Å–∫–ª–∞–¥",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤ –¥–æ –Ω–∞–∑–µ–º–Ω–æ—ó –∞—Ä—Ç–∏–ª–µ—Ä—ñ—ó","–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∏—Ö –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤","–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–æ—ó –∑–±—Ä–æ—ó",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–∞—Å–æ–±—ñ–≤ –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤","–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ–º, —Ä–µ—á–æ–≤–∏–º —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–∏–º –º–∞–π–Ω–æ–º",
  "–í–∑–≤–æ–¥ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è","–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞, —Ä–µ—á–æ–≤–æ–≥–æ —ñ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞",
  "–°–∫–ª–∞–¥ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞","–ü—Ä–æ–¥–æ–≤–æ–ª—å—á–∏–π —Å–∫–ª–∞–¥","–†–µ—á–æ–≤–∏–π —Å–∫–ª–∞–¥","–ì–æ—Å–ø–æ–¥–∞—Ä—á–∏–π –≤–∑–≤–æ–¥","–á–¥–∞–ª—å–Ω—è",
  "–†–µ–º–æ–Ω—Ç–Ω–∞ –º–∞–π—Å—Ç–µ—Ä–Ω—è —Ä–µ—á–æ–≤–æ–≥–æ –º–∞–π–Ω–∞","–ü–æ–ª—å–æ–≤–∞ –ª–∞–∑–Ω—è","–°–∫–ª–∞–¥–∏","–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤","2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "–í–∑–≤–æ–¥ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ-–µ–≤–∞–∫—É–∞—Ü—ñ–π–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º","1 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "2 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤","–í—ñ–¥—ñ–ª–µ–Ω–Ω—è –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤","–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É",
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ü–∏–≤—ñ–ª—å–Ω–æ-–≤—ñ–π—Å—å–∫–æ–≤–æ–≥–æ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏—Ü—Ç–≤–∞","–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É","–í–∑–≤–æ–¥ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è","–ì–æ—Å–ø–æ–¥–∞—Ä—á–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è","–ü–æ–ª—å–æ–≤–∞ –ª–∞–∑–Ω—è","–ü–æ–∂–µ–∂–Ω–∞ –æ–±—Å–ª—É–≥–∞","–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç"
];

// === –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É ===
async function checkAccess() {
  const pass = prompt("üîê –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥—É:");
  let role = null;
  for (const [key, value] of Object.entries(roles)) if (pass === value) role = key;

  if (!role) {
    document.body.innerHTML = "<h2 style='color:#ff6;text-align:center;margin-top:50px;'>‚ùå –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ</h2>";
    throw new Error("Unauthorized");
  }

  document.querySelector('header').innerHTML =
    `–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó ‚Äî <span style='color:#9fffa1;font-size:0.8em;'>${role.toUpperCase()}</span>`;
  document.getElementById("logout").style.display = "block";
  document.getElementById("logout").onclick = () => location.reload();
  await loadCSV(role);
}

// === –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV ===
async function loadCSV(role) {
  const response = await fetch("bmz.csv");
  const text = await response.text();
  const rows = text.split("\n").slice(1).map(r => r.trim()).filter(r => r);
  const table = document.querySelector("#dataTable tbody");
  table.innerHTML = "";
  let units = new Set();

  rows.forEach(row => {
    const [unit, code, posada, shpk, tr, vos, rank, pib, pibLat] = row.split(";").map(v => v.trim());
    if (unit) units.add(unit);
    if (role !== "admin" && code.toLowerCase() !== role.toLowerCase()) return;

    const trEl = document.createElement("tr");

    // === –Ø–∫—â–æ —Ü–µ —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É ===
    if (unitNames.includes(posada) || (!pib && posada && unitNames.includes(posada.trim()))) {
      trEl.classList.add("divider-row");
      const td = document.createElement("td");
      td.colSpan = 5;
      td.textContent = posada.trim();
      trEl.appendChild(td);
      table.appendChild(trEl);
      return;
    }

    // === –ó–≤–∏—á–∞–π–Ω–∏–π —Ä—è–¥–æ–∫ ===
    const htmlPath = `foto/${pibLat}.html`;
    const photoPath = `photos/${pibLat}.jpg`;
    const pibCell = pibLat
      ? `<span class="pib-link" data-photo="${photoPath}" data-html="${htmlPath}">${pib}</span>`
      : (pib || "");

    trEl.innerHTML = `
      <td>${code ? code.toUpperCase() : ""}</td>
      <td>${posada}</td>
      <td>${pibCell}</td>
      <td class="shpk-cell">${shpk}</td>
      <td class="rank-cell">${rank}</td>
    `;

    // === –ö–æ–ª—å–æ—Ä–∏ –∑–∞ –∑–≤–∞–Ω–Ω—è–º ===
    const shpkCell = trEl.querySelector(".shpk-cell");
    const rankCell = trEl.querySelector(".rank-cell");
    const green = ["–º–æ–ª–æ–¥—à–∏–π —Å–µ—Ä–∂–∞–Ω—Ç","—Å–µ—Ä–∂–∞–Ω—Ç","—Å—Ç–∞—Ä—à–∏–π —Å–µ—Ä–∂–∞–Ω—Ç","–≥–æ–ª–æ–≤–Ω–∏–π —Å–µ—Ä–∂–∞–Ω—Ç","–º–∞–π—Å—Ç–µ—Ä-—Å–µ—Ä–∂–∞–Ω—Ç","—à—Ç–∞–±-—Å–µ—Ä–∂–∞–Ω—Ç"];
    const red = ["–º–æ–ª–æ–¥—à–∏–π –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","–ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","—Å—Ç–∞—Ä—à–∏–π –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","–∫–∞–ø—ñ—Ç–∞–Ω","–º–∞–π–æ—Ä","–ø—ñ–¥–ø–æ–ª–∫–æ–≤–Ω–∏–∫"];
    if (green.includes(shpk.toLowerCase())) { shpkCell.classList.add("shpk-green"); rankCell.classList.add("rank-green"); }
    if (red.includes(shpk.toLowerCase())) { shpkCell.classList.add("shpk-red"); rankCell.classList.add("rank-red"); }

    trEl.querySelectorAll(".pib-link").forEach(span => {
      span.addEventListener("click", e => {
        const photo = e.target.dataset.photo;
        const html = e.target.dataset.html;
        showPhoto(photo, html);
      });
    });

    table.appendChild(trEl);
  });

  // === –§—ñ–ª—å—Ç—Ä –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ ===
  const filter = document.querySelector("#unitFilter");
  filter.innerHTML = `<option value="all">–í—Å—ñ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏</option>`;
  units.forEach(u => filter.innerHTML += `<option value="${u}">${u}</option>`);
  filter.onchange = () => {
    const val = filter.value;
    document.querySelectorAll("#dataTable tbody tr").forEach(tr => {
      const cell = tr.querySelector("td:first-child");
      if (!cell) return;
      tr.style.display = (val === "all" || cell.textContent.trim() === val) ? "" : "none";
    });
  };
}

// === –ú–æ–¥–∞–ª—å–Ω–µ —Ñ–æ—Ç–æ –∑ –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è–º ===
function showPhoto(photoPath, htmlPath) {
  const modal = document.createElement("div");
  modal.className = "modal";
  modal.innerHTML = `
    <img src="${photoPath}" alt="–§–æ—Ç–æ" />
    <button>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é</button>
  `;
  document.body.appendChild(modal);
  setTimeout(() => modal.classList.add("active"), 20);

  modal.querySelector("img").onclick = () => window.location.href = htmlPath;
  modal.querySelector("button").onclick = () => window.location.href = htmlPath;

  modal.onclick = e => {
    if (e.target === modal) {
      modal.classList.remove("active");
      setTimeout(() => modal.remove(), 400);
    }
  };
}

checkAccess();
</script>
</body>
</html>
