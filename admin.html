<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó</title>
<link rel="icon" type="image/png" href="favicon.png">
<style>
  body{background:#1a1a1a;color:#f5f5f5;font-family:"Segoe UI",sans-serif;margin:0;padding:0}
  header{background:#111;padding:15px;text-align:center;font-size:1.6em;color:#00c0c4;border-bottom:2px solid #00c0c4}
  #logout{position:absolute;top:15px;right:20px;background:#00c0c4;color:#111;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;display:none}
  select{margin:15px 20px;background:#2a2a2a;color:#fff;border:1px solid #444;border-radius:6px;padding:5px 10px}
  table{width:96%;margin:0 auto 30px auto;border-collapse:collapse}
  th,td{border-bottom:1px solid #333;padding:10px;text-align:left}
  th{background:#222;color:#8aff8a}
  tr:hover td{background:#252525}
  td a,.pib-link{color:#00c0c4;text-decoration:none;font-weight:bold;cursor:pointer}
  td a:hover,.pib-link:hover{color:#80ffff}
  footer{text-align:center;font-size:0.9em;color:#888;padding-bottom:20px}
  .divider-row td{background:#3a3000;color:#ffeb80;font-weight:bold;text-align:center;
    border-top:2px solid #555;border-bottom:2px solid #555;padding:8px 0;}
  .vacant{opacity:.6;font-style:italic}
  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;
    z-index:9999;opacity:0;transition:opacity .4s ease,background .4s ease;background:rgba(0,0,0,0)}
  .modal.active{background:rgba(0,0,0,.9);opacity:1}
  .modal img{max-width:60%;border:3px solid #9fffa1;border-radius:10px;cursor:pointer;transition:transform .3s}
  .modal img:hover{transform:scale(1.02)}
  .modal button{margin-top:15px;padding:6px 14px;background:#00c0c4;color:#fff;border:none;border-radius:6px;cursor:pointer}
  .modal button:hover{background:#22d4d8}
</style>
</head>
<body>
<header id="header">–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó</header>
<button id="logout">üö™ –í–∏–π—Ç–∏</button>

<select id="unitFilter"><option value="all">–í—Å—ñ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏</option></select>

<table id="dataTable">
  <thead>
    <tr>
      <th>–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</th><th>–ü–æ—Å–∞–¥–∞</th><th>–ü–Ü–ë</th><th>–®–ü–ö</th><th>–í—ñ–π—Å—å–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<footer>¬© 2025 –ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è | –í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É</footer>

<script>
// ---- –†–æ–ª—ñ / –ø–∞—Ä–æ–ª—ñ –¥–æ—Å—Ç—É–ø—É ----
const roles = {
  admin: "admin123",
  upr: "upr123",
  rzb: "rzb123",
  rzpr: "rzpr123",
  pmm: "pmm123",
  lebns: "lebns123",
  vzv: "vzv123",
  cvs: "cvs123",
  rekr: "rekr123",
  vmz: "vmz123",
  po: "po123",
  mp: "mp123"
};



// ---- –ó–≤‚Äô—è–∑–æ–∫ —Ä–æ–ª–µ–π –∑ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞–º–∏ ----
const roleUnits = {
  admin: "all",
  upr: "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
  rzb: "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å–∞–º–∏",
  rzpr: "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ–º, —Ä–µ—á–æ–≤–∏–º —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–∏–º –º–∞–π–Ω–æ–º",
  pmm: "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  lebns: "–í–∑–≤–æ–¥ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ-–µ–≤–∞–∫—É–∞—Ü—ñ–π–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º",
  vzv: "–í–∑–≤–æ–¥ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  cvs: "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É",
  rekr: "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É",
  vmz: "–í–∑–≤–æ–¥ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  po: "–ü–æ–∂–µ–∂–Ω–∞ –æ–±—Å–ª—É–≥–∞",
  mp: "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç"
};

// ---- –ü–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ ----
const unitNames = Array.from(new Set([
 "–ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å–∞–º–∏",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–¢–∞–∫–µ–ª–∞–∂–Ω–∏–π –≤–∑–≤–æ–¥",
  "–¢–∞–∫–µ–ª–∞–∂–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ü–æ–ª—å–æ–≤–∏–π –∞—Ä—Ç–∏–ª–µ—Ä—ñ–π—Å—å–∫–∏–π —Å–∫–ª–∞–¥",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–Ω–∞—Ä—è–¥—ñ–≤",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤ –¥–æ –Ω–∞–∑–µ–º–Ω–æ—ó –∞—Ä—Ç–∏–ª–µ—Ä—ñ—ó",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∏—Ö –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–æ—ó –∑–±—Ä–æ—ó",
  "–ì—Ä—É–ø–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–∞—Å–æ–±—ñ–≤ –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ–º, —Ä–µ—á–æ–≤–∏–º —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–∏–º –º–∞–π–Ω–æ–º",
  "–í–∑–≤–æ–¥ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞, —Ä–µ—á–æ–≤–æ–≥–æ —ñ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞",
  "–°–∫–ª–∞–¥ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –º–∞–π–Ω–∞",
  "–ü—Ä–æ–¥–æ–≤–æ–ª—å—á–∏–π —Å–∫–ª–∞–¥",
  "–†–µ—á–æ–≤–∏–π —Å–∫–ª–∞–¥",
  "–ì–æ—Å–ø–æ–¥–∞—Ä—á–∏–π –≤–∑–≤–æ–¥",
  "–á–¥–∞–ª—å–Ω—è",
  "–†–µ–º–æ–Ω—Ç–Ω–∞ –º–∞–π—Å—Ç–µ—Ä–Ω—è —Ä–µ—á–æ–≤–æ–≥–æ –º–∞–π–Ω–∞",
  "–ü–æ–ª—å–æ–≤–∞ –ª–∞–∑–Ω—è",
  "–°–∫–ª–∞–¥–∏",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "1 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "2 –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤",
  "–í–∑–≤–æ–¥ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ-–µ–≤–∞–∫—É–∞—Ü—ñ–π–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º",
  "1 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "2 –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–í—ñ–¥—ñ–ª–µ–Ω–Ω—è –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –∞–≤—ñ–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å—ñ–≤",
  "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É",
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ü–∏–≤—ñ–ª—å–Ω–æ-–≤—ñ–π—Å—å–∫–æ–≤–æ–≥–æ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏—Ü—Ç–≤–∞",
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É",
  "–í–∑–≤–æ–¥ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è",
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ì–æ—Å–ø–æ–¥–∞—Ä—á–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è",
  "–ü–æ–∂–µ–∂–Ω–∞ –æ–±—Å–ª—É–≥–∞",
  "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç"
]));


// ---- –ö–æ–ª—å–æ—Ä–∏ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ ----
const defaultColors = {
  "–ë–∞—Ç–∞–ª—å–π–æ–Ω –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è": { bg: "#0f3b3b", color: "#9fffa1" },
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–æ—î–ø—Ä–∏–ø–∞—Å–∞–º–∏": { bg: "#2b1a00", color: "#ffd980" },
  "–†–æ—Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ–º, —Ä–µ—á–æ–≤–∏–º —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ-—Ç–µ—Ö–Ω—ñ—á–Ω–∏–º –º–∞–π–Ω–æ–º": { bg: "#2a1b1b", color: "#ffb7b7" },
  "–ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –≤–∑–≤–æ–¥ –ø—ñ–¥–≤–æ–∑—É –ø–∞–ª—å–Ω–æ–≥–æ —Ç–∞ –º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤": { bg: "#1b2b1b", color: "#a8ffb0" },
  "–í–∑–≤–æ–¥ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ-–µ–≤–∞–∫—É–∞—Ü—ñ–π–Ω–∏—Ö –±–µ–∑–ø—ñ–ª–æ—Ç–Ω–∏—Ö –Ω–∞–∑–µ–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º": { bg: "#102030", color: "#8cecff" },
  "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É": { bg: "#1a1033", color: "#bfa0ff" },
  "–ì—Ä—É–ø–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É": { bg: "#0f2a1a", color: "#99ffd8" },
  "–í–∑–≤–æ–¥ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è": { bg: "#0e1f2a", color: "#9fd8ff" },
  "–ü–æ–∂–µ–∂–Ω–∞ –æ–±—Å–ª—É–≥–∞": { bg: "#2a0d0d", color: "#ffb0a0" },
  "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç": { bg: "#10301c", color: "#a8ffd8" }
};

// === –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è ===
async function checkAccess() {
  const pass = prompt("üîê –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥—É:");
  let role = null;
  for (const [k, v] of Object.entries(roles)) if (pass === v) role = k;
  if (!role) {
    document.body.innerHTML = "<h2 style='color:#ff6;text-align:center;margin-top:50px;'>‚ùå –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ</h2>";
    throw new Error("Unauthorized");
  }

  const unitName = roleUnits[role] || "all";
  const header = document.getElementById("header");
  header.innerHTML = `–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å –ë–ú–ó ‚Äî <span style='color:#9fffa1;font-size:.8em;'>${role.toUpperCase()}${unitName !== "all" ? " (" + unitName + ")" : ""}</span>`;

  document.getElementById("logout").style.display = "block";
  document.getElementById("logout").onclick = () => location.reload();

  await loadCSV(role);
}

// === –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ ===
async function loadCSV(role) {
  const res = await fetch("bmz.csv");
  const txt = await res.text();
  const rows = txt.split("\n").slice(1).map(r => r.trim()).filter(r => r);
  const tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "";
  const unitsSet = new Set();
  const shownDividers = new Set();
  const unitFilterRole = roleUnits[role] || "all";

  rows.forEach(row => {
    const parts = row.split(";").map(v => v.trim());
    const unit = parts[0] || "";
    const code = parts[1] || "";
    const posada = parts[2] || "";
    const shpk = parts[3] || "";
    const rank = parts[6] || "";
    const pib = parts[7] || "";
    const pibLat = parts[8] || "";

    // ---- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Ä–æ–ª–ª—é ----
    if (unitFilterRole !== "all" && unit !== unitFilterRole) return;

    // === –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É ===
   // === –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É ===
if (!pib) {
  const dividerName = posada || unit;
  const dividerLower = dividerName.toLowerCase();

  // —è–∫—â–æ —Ü–µ –ø—Ä–æ—Å—Ç–æ –≤–∞–∫–∞–Ω—Ç–Ω–∞ –ø–æ—Å–∞–¥–∞ ‚Äî –Ω–µ —Å—Ç–≤–æ—Ä—é—î–º–æ "–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª"
  const isJobTitle =
    dividerLower.includes("—Å–µ—Ä–∂–∞–Ω—Ç") ||
    dividerLower.includes("–æ—Ñ—ñ—Ü–µ—Ä") ||
    dividerLower.includes("–Ω–∞—á–∞–ª—å–Ω–∏–∫") ||
    dividerLower.includes("–∫–æ–º–∞–Ω–¥–∏—Ä") ||
    dividerLower.includes("–≤–æ–¥—ñ–π") ||
    dividerLower.includes("–∫–æ–º—ñ—Ä–Ω–∏–∫") ||
    dividerLower.includes("–∑–≤‚Äô—è–∑–∫—É");

  // —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª ‚Äî —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤ —Å–ø–∏—Å–∫—É unitNames —ñ –Ω–µ —î –ø–æ—Å–∞–¥–∞
  if (unitNames.includes(dividerName) && !isJobTitle) {
    if (!shownDividers.has(dividerName)) {
      const trDiv = document.createElement("tr");
      trDiv.className = "divider-row";
      const td = document.createElement("td");
      td.colSpan = 5;
      td.textContent = dividerName;
      if (defaultColors[dividerName]) {
        td.style.backgroundColor = defaultColors[dividerName].bg;
        td.style.color = defaultColors[dividerName].color;
      }
      trDiv.appendChild(td);
      tbody.appendChild(trDiv);
      shownDividers.add(dividerName);
      unitsSet.add(dividerName);
    }
    return;
  }
}


    // === –†—è–¥–æ–∫ –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É ===
    const tr = document.createElement("tr");
    if (!pib) tr.classList.add("vacant");
    const htmlPath = pibLat ? `foto/${pibLat}.html` : "";
    const photoPath = pibLat ? `photos/${pibLat}.jpg` : "";
    const pibCell = pibLat
      ? `<span class="pib-link" data-photo="${photoPath}" data-html="${htmlPath}">${pib}</span>`
      : `<span style='color:#777;font-style:italic'>–í–∞–∫–∞–Ω—Ç–Ω–æ</span>`;
    tr.innerHTML = `
      <td>${code}</td>
      <td>${posada}</td>
      <td>${pibCell}</td>
      <td>${shpk}</td>
      <td>${rank}</td>
    `;
    tbody.appendChild(tr);
    unitsSet.add(unit);

    // === –£–º–æ–≤–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è ===
    const normalize = v => (v || "").toString().trim().toLowerCase();
    const shpkText = normalize(shpk);
    const rankText = normalize(rank);
    const sergeantRanks = ["–º–æ–ª–æ–¥—à–∏–π —Å–µ—Ä–∂–∞–Ω—Ç","—Å–µ—Ä–∂–∞–Ω—Ç","—Å—Ç–∞—Ä—à–∏–π —Å–µ—Ä–∂–∞–Ω—Ç","—à—Ç–∞–±-—Å–µ—Ä–∂–∞–Ω—Ç","–º–∞–π—Å—Ç–µ—Ä-—Å–µ—Ä–∂–∞–Ω—Ç"];
    const officerRanks = ["–º–æ–ª–æ–¥—à–∏–π –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","–ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","—Å—Ç–∞—Ä—à–∏–π –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç","–∫–∞–ø—ñ—Ç–∞–Ω","–º–∞–π–æ—Ä","–ø—ñ–¥–ø–æ–ª–∫–æ–≤–Ω–∏–∫"];
    const tdShpk = tr.children[3];
    const tdRank = tr.children[4];

    if (sergeantRanks.some(r => shpkText.includes(r) || rankText.includes(r))) {
      tdShpk.style.color = "#7fff7f";
      tdRank.style.color = "#7fff7f";
      tdShpk.style.fontWeight = "bold";
      tdRank.style.fontWeight = "bold";
    }
    if (officerRanks.some(r => shpkText.includes(r) || rankText.includes(r))) {
      tdShpk.style.color = "#ff7070";
      tdRank.style.color = "#ff7070";
      tdShpk.style.fontWeight = "bold";
      tdRank.style.fontWeight = "bold";
    }
  });

  // === –§—ñ–ª—å—Ç—Ä ===
  const filter = document.getElementById("unitFilter");
  filter.innerHTML = `<option value="all">–í—Å—ñ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∏</option>`;
  Array.from(unitsSet).sort().forEach(u => {
    const opt = document.createElement("option");
    opt.value = u;
    opt.textContent = u;
    filter.appendChild(opt);
  });

  filter.onchange = () => {
    const val = filter.value;
    document.querySelectorAll("#dataTable tbody tr").forEach(tr => {
      if (tr.classList.contains("divider-row")) {
        tr.style.display = (val === "all" || tr.textContent.trim() === val) ? "" : "none";
      } else {
        let prev = tr.previousElementSibling;
        while (prev && !prev.classList.contains("divider-row")) prev = prev.previousElementSibling;
        const parentUnit = prev ? prev.textContent.trim() : "";
        tr.style.display = (val === "all" || parentUnit === val) ? "" : "none";
      }
    });
  };

  // === –ö–ª—ñ–∫ –ø–æ –ü–Ü–ë ===
  document.querySelectorAll(".pib-link").forEach(el => {
    el.addEventListener("click", () => {
      const photo = el.dataset.photo;
      const html = el.dataset.html;
      if (photo) {
        const modal = document.createElement("div");
        modal.className = "modal active";
        modal.innerHTML = `<img src="${photo}" alt="–§–æ—Ç–æ"><button>–ó–∞–∫—Ä–∏—Ç–∏</button>`;
        document.body.appendChild(modal);
        modal.querySelector("button").onclick = () => modal.remove();
        modal.onclick = e => { if (e.target === modal) modal.remove(); };
        const img = modal.querySelector("img");
        if (html) {
          img.style.cursor = "pointer";
          img.onclick = e => { e.stopPropagation(); window.open(html, "_blank"); };
        }
      } else if (html) {
        window.open(html, "_blank");
      }
    });
  });
}

checkAccess();
</script>
</body>
</html>
